<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MILLENNIAL COLORS by The Color Blocks</title>
    <link rel="shortcut icon" type="image/jpg" href="logo.png"/>
    <link rel="stylesheet" href="/styles/normalize.css" />
    <link rel="stylesheet" href="/styles/barebones.css" />
    <link rel="stylesheet" href="/styles/app.css" />
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  </head>
  <body x-data="{
    baseurl: 'https://turbo.ordinalswallet.com/inscription/content',
    marketBaseurl: 'https://ordinalswallet.com/inscription',
    idMaxLength: 20,
    colors: [],
    query: '',
    searchedColors (){
      // Return all if query is empty
      if (this.query.length === 0) return this.colors;
      // Init search
      this.showSearchResults = false;
      // Split query into words
      let query = this.query.split(' ');
      // Filter colors by query
      let results = this.colors.filter(item => {
        return query.every(word => {
          return `${item.name} ${item.hex} ${item.decade}`.toLowerCase().includes(word.toLowerCase());
        });
      });
      this.showSearchResults = true;
      return results;
    },
    get resultsEmpty() {
      return this.searchedColors().length === 0;
    },
    async getColors() {
      const response = await fetch('/collection/inscriptions.json');
      const colorsResp = await response.json();
      const colors = [];

      colorsResp.forEach( color => {
        const c = {
          id: color.id,
          name: color.meta.name.match(/\((.*)\)/)[1],
          hex: `#${color.meta.attributes[0].value}`,
          decade: color.meta.attributes[1].value,
          image: `${this.baseurl}/${color.id}`
        }
        colors.push(c)
      });
      return colors;
    },
    shortenString(str) {
      if (str.length <= this.idMaxLength) {
        return str;
      }
      const ellipsis = '...';
      const ellipsisLength = ellipsis.length;
      const midpoint = Math.floor((this.idMaxLength - ellipsisLength) / 2);
      const beginning = str.slice(0, midpoint);
      const end = str.slice(-midpoint);
      return `${beginning}${ellipsis}${end}`;
    },
    async init() {
      this.colors = await this.getColors();
    }
  }">
    <div class="border top">
      <template x-for="color in colors.slice(0, 30)">
        <div class="border-item" :style="{ backgroundColor: color.hex }"></div>
      </template>
    </div>
    <div class="display punctuate" x-init="await init()">
      <h1>MILLENNIAL COLORS</h1>
    </div>
    <div class="display">
      <p>Inspired by <a href="https://juiceboxinteractive.com/blog/color/" target="_blank">Juicebox Interactive &#8680</a></p>
    </div>
    <div class="display punctuate">
      <a class="icon" href="https://twitter.com/thecolorblocks_" target="_blank">
        <svg viewBox="0 0 24 24" aria-hidden="true"><g><path fill="#000000" d="M23.643 4.937c-.835.37-1.732.62-2.675.733.962-.576 1.7-1.49 2.048-2.578-.9.534-1.897.922-2.958 1.13-.85-.904-2.06-1.47-3.4-1.47-2.572 0-4.658 2.086-4.658 4.66 0 .364.042.718.12 1.06-3.873-.195-7.304-2.05-9.602-4.868-.4.69-.63 1.49-.63 2.342 0 1.616.823 3.043 2.072 3.878-.764-.025-1.482-.234-2.11-.583v.06c0 2.257 1.605 4.14 3.737 4.568-.392.106-.803.162-1.227.162-.3 0-.593-.028-.877-.082.593 1.85 2.313 3.198 4.352 3.234-1.595 1.25-3.604 1.995-5.786 1.995-.376 0-.747-.022-1.112-.065 2.062 1.323 4.51 2.093 7.14 2.093 8.57 0 13.255-7.098 13.255-13.254 0-.2-.005-.402-.014-.602.91-.658 1.7-1.477 2.323-2.41z"></path></g></svg>
      </a>
      <a class="icon" href="https://ordinalswallet.com/collection/millennial-colors" target="_blank">
        <svg viewBox="0 0 46 46" xmlns="http://www.w3.org/2000/svg">
          <circle opacity="0.2" cx="23" cy="23" r="23" fill="url(#paint0_linear_5446_24848)"/>
          <circle opacity="0.2" cx="23.0007" cy="22.9998" r="16.2146" fill="url(#paint1_linear_5446_24848)"/>
          <g filter="url(#filter0_d_5446_24848)">
            <circle cx="23.0009" cy="23.0001" r="9.60536" fill="url(#paint2_linear_5446_24848)"/>
          </g>
          <defs>
            <filter id="filter0_d_5446_24848" x="12.2974" y="13.3948" width="21.4072" height="21.407" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dy="1.09814"/>
              <feGaussianBlur stdDeviation="0.549072"/>
              <feComposite in2="hardAlpha" operator="out"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_5446_24848"/>
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_5446_24848" result="shape"/>
            </filter>
            <linearGradient id="paint0_linear_5446_24848" x1="-20.5853" y1="23.236" x2="23.236" y2="67.0573" gradientUnits="userSpaceOnUse">
              <stop stop-color="#525252"/>
              <stop offset="1" stop-color="#1f1f1f"/>
            </linearGradient>
            <linearGradient id="paint1_linear_5446_24848" x1="-7.72612" y1="23.1662" x2="23.167" y2="54.0594" gradientUnits="userSpaceOnUse">
              <stop stop-color="#525252"/>
              <stop offset="1" stop-color="#1f1f1f"/>
            </linearGradient>
            <linearGradient id="paint2_linear_5446_24848" x1="4.79857" y1="23.0987" x2="23.0994" y2="41.3995" gradientUnits="userSpaceOnUse">
              <stop stop-color="#525252"/>
              <stop offset="1" stop-color="#1f1f1f"/>
            </linearGradient>
          </defs>
        </svg>
      </a>
    </div>
    <div class="display punctuate match-width">
      <input class="u-full-width" type="text" x-model="query" placeholder="Search by color name, hex, or decade" />
    </div>
    <template x-for="color in searchedColors('blue')">
      <div class="display">
        <div class="colorblocks" :style="{ backgroundImage: `url('${color.image}')` }">
          <span class="colortexts" x-text="color.name.toUpperCase()" :style="`-webkit-text-stroke-color: ${color.hex};`"></span>
          <span class="metadata">
            <ul>
              <li><em x-text="`MLCS ${color.hex} (${color.name})`"></em></li>
              <li><a x-text="`${shortenString(color.id)} â‡¨`" :href="`${marketBaseurl}/${color.id}`" target="_blank"></a></li>
              <li x-text="color.decade"></li>
            </ul>
          </span>
        </div>
      </div>
    </template>
    <div class="display" x-show="resultsEmpty">
      <div class="colorblocks">
        <span class="colortexts" style="color: black;">NGMI?</span>
      </div>
    </div>
    <div class="display punctuate">
      <h4>
        <a href="https://twitter.com/thecolorblocks_" target="_blank" style="text-decoration: none;">@thecolorblocks_</a>
      </h4>
    </div>
    <div class="border bottom">
      <template x-for="color in colors.slice(30)">
        <div class="border-item" :style="{ backgroundColor: color.hex }"></div>
      </template>
    </div>
  </body>
</html>
